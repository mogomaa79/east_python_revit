def get_characteristics():
    """
    Function to gather nominal size and species information from the user.
    Returns the nominal size and thickness in inches.
    """
    input_nominal_size = get_option("Please enter nominal size: ", inch_options)
    species_nominal = get_int("Please choose between Douglas-Fir-Larch (1), Hem-Fir (2), Spruce-Pine-Fir (3): ", 1, 3)
    species_grade = get_int("Please choose species grade (1 or 2): ", 1, 2)
    direction = get_int("Please choose X (1) or Y (2) direction: ", 1, 2)
    direction = "x" if direction == 1 else "y"

    # Displaying nominal values and selected species details
    print(f"Nominal Values: {big_table[input_nominal_size]}")
    i = big_table[input_nominal_size]["I" + direction]
    s = big_table[input_nominal_size]["S" + direction]

    species_nominal = species_nominal_mapper[species_nominal]
    values = species_and_nominal_table[f"{species_nominal}{species_grade}"]
    print(f"Grade: {values}")

    return input_nominal_size, i, s, values

def get_float(prompt):
    """Function to get valid float input with error handling."""
    while True:
        try:
            value = float(input(prompt))
            return value
        except ValueError:
            print("Invalid Number! Please enter a valid number.")

def get_int(prompt, min_value=None, max_value=None):
    while True:
        try:
            value = int(input(prompt))
            if (min_value is not None and value < min_value) or (max_value is not None and value > max_value):
                raise ValueError
            return value
        except ValueError:
            print(f"Please enter a valid integer between {min_value} and {max_value}.")

def get_option(prompt, options, float=False):
    """Function to get valid option input with error handling."""
    while True:
        if float:
            value = get_float(prompt)
        else:
            value = input(prompt)

        if value in options:
            return value
        print(f"Invalid Option! Please choose between {options}.")

# Options for non-motorized and motorized types
non_motorized_options = {
    0.10: 4.8,
    0.13: 5.4,
    0.15: 6.0,
    0.18: 6.6,
    0.20: 7.2,
    0.23: 7.8,
    0.25: 8.4,
    0.30: 9.6,
}

motorized_options = {
    0.10: 6.0,
    0.13: 6.6,
    0.15: 7.2,
    0.18: 7.8,
    0.20: 8.4,
    0.23: 9.0,
    0.25: 9.6,
    0.30: 10.8,
}

# Thickness options and corresponding weights for plyform, different species, and structural marine plywoods
thickness_options = [0, 0.10, 0.13, 0.15, 0.18, 0.20, 0.23, 0.25, 0.30, 1]
plyform_thickness = [11.9, 12.7, 15.1, 15.9, 18.25, 19.05, 22.22, 25.4, 28.6]
different_species_thickness = [6.78, 7.32, 10.80, 13.97, 14.43, 14.88, 20.75, 21.23]
structural_marine_thickness = [8.69, 9.47, 13.84, 18.21, 19.00, 19.76, 27.71, 28.47]

# Approximate weights for plyform
plyform_weight_by_thickness = {
    11.9: 0.07,
    12.7: 0.07,
    15.1: 0.08,
    15.9: 0.09,
    18.25: 0.10,
    19.05: 0.11,
    22.22: 0.12,
    25.4: 0.14,
    28.6: 0.16,
}

# Plyform properties across classes and directions (across and along)
plyform_across_class_1 = {
    11.9: [8372.8, 1218.9, 932.6],
    12.7: [9768.3, 1338.8, 1013.3],
    15.1: [14589, 1673.5, 1069.3],
    15.9: [16491.9, 1788.4, 1124.2],
    18.25: [22835, 2148, 1378.2],
    19.05: [25245.4, 2272.9, 1413.2],
    22.22: [37550.9, 2917.3, 1682.2],
    25.4: [54169.7, 3681.6, 1843.3],
    28.6: [70281.1, 4241.1, 2050.9],
}

plyform_across_class_2 = {
    11.9: [7992.3, 1213.9, 884.7],
    12.7: [9514.6, 1333.8, 961.7],
    15.1: [14589, 1668.5, 1047.3],
    15.9: [16491.9, 1783.4, 1099.8],
    18.25: [22835, 2148, 1278.9],
    19.05: [25118.5, 2267.9, 1303.9],
    22.22: [38058.3, 2952.3, 1571.1],
    25.4: [53408.5, 3766.6, 1693.8],
    28.6: [71803.4, 4341, 1882],
}

plyform_across_structural_1 = {
    11.9: [8499.7, 1228.9, 885.4],
    12.7: [9895.2, 1353.8, 965.1],
    15.1: [14715.9, 1688.5, 986.7],
    15.9: [16618.8, 1803.3, 1033.9],
    18.25: [23215.6, 2193, 1201.2],
    19.05: [25626, 2317.9, 1217],
    22.22: [40215, 3127.1, 1482.4],
    25.4: [60766.5, 4131.2, 1568.8],
    28.6: [79034.5, 4770.6, 1738.5],
}

plyform_along_class_1 = {
    11.9: [2283.5, 534.5, 475.7],
    12.7: [3044.7, 649.4, 538.6],
    15.1: [3679, 729.3, 557.3],
    15.9: [4820.7, 874.2, 608.4],
    18.25: [9134, 1233.9, 746.8],
    19.05: [11671.2, 1528.6, 798.9],
    22.22: [19156, 2108.1, 1185.3],
    25.4: [34252.5, 3167.1, 1379.2],
    28.6: [50490.7, 3991.3, 1655.5],
}

plyform_along_class_2 = {
    11.9: [1902.9, 689.4, 478.6],
    12.7: [2537.2, 834.2, 536.2],
    15.1: [3171.5, 939.1, 552.9],
    15.9: [4059.6, 1124, 604.5],
    18.25: [7611.7, 1583.6, 743.5],
    19.05: [9514.6, 1958.2, 796.2],
    22.22: [15603.9, 2707.5, 1179.2],
    25.4: [27909.5, 4056.3, 1373.9],
    28.6: [40976.2, 5110.3, 1649.4],
}

plyform_along_structural_1 = {
    11.9: [2664.1, 734.3, 472.9],
    12.7: [3679, 889.2, 535.8],
    15.1: [4313.3, 994.1, 552.7],
    15.9: [5708.8, 1188.9, 604.3],
    18.25: [10783.2, 1688.5, 743.3],
    19.05: [13701, 2088.1, 795.8],
    22.22: [22708.1, 2892.4, 1178],
    25.4: [40722.4, 4346, 1372.7],
    28.6: [60132.2, 5485, 1647.2],
}

# Plyform mapper for easy access to classes and directions
plyform_general_mapper = {
    "1_1": plyform_across_class_1,
    "2_1": plyform_across_class_2,
    "3_1": plyform_across_structural_1,
    "1_2": plyform_along_class_1,
    "2_2": plyform_along_class_2,
    "3_2": plyform_along_structural_1,
}

# Weight data for plywood (different species and marine)
plywood_weight_different = {
    6.78: 0.038,
    7.32: 0.053,
    10.8: 0.072,
    13.97: 0.086,
    14.43: 0.105,
    14.88: 0.124,
    20.75: 0.144,
    21.23: 0.158,
}

plywood_weight_marine = {
    8.69: 0.038,
    9.47: 0.053,
    13.84: 0.072,
    18.21: 0.086,
    19: 0.105,
    19.76: 0.124,
    27.71: 0.144,
    28.47: 0.158,
}

# Plywood properties across different species and marine
plywood_across_different = {
    6.78: [195.8, 1014.9, 294.7, 395.2],
    7.32: [257, 3425.3, 624.4, 607.2],
    10.8: [382.8, 9768.3, 1178.9, 878.2],
    13.97: [486.7, 16365.1, 1693.5, 1145.2],
    14.43: [567.1, 24991.6, 2058.1, 1329.6],
    14.88: [578.5, 35267.4, 2572.6, 1582.9],
    20.75: [731.7, 53662.3, 3317, 1746.5],
    21.23: [757.8, 69519.9, 4096.3, 1943.3],
}

plywood_across_marine = {
    8.69: [251.7, 1522.3, 414.6, 395],
    9.47: [330.3, 4820.7, 884.2, 606.8],
    13.84: [382.8, 9895.2, 1353.8, 876.4],
    18.21: [611.9, 16618.8, 1803.3, 1166.8],
    19: [756.7, 25626, 2317.9, 1217],
    19.76: [777.1, 36536, 2842.4, 1482.4],
    27.71: [1025.5, 60766.5, 4131.2, 1568.8],
    28.47: [1099.8, 79034.5, 4770.6, 1738.5],
}

plywood_along_different = {
    6.78: [68.4, 126.9, 45, 397],
    7.32: [123.1, 253.7, 114.9, 690.2],
    10.8: [243.8, 1141.8, 434.6, 541.1],
    13.97: [300.5, 3425.3, 819.3, 613.3],
    14.43: [409.2, 7992.3, 1423.7, 802.1],
    14.88: [521.3, 13193.6, 1968.2, 998.5],
    20.75: [622, 23469.3, 2952.3, 1382.5],
    21.23: [625.3, 34379.4, 3716.6, 1657.2],
}

plywood_along_marine = {
    8.69: [123.1, 126.9, 64.9, 535.4],
    9.47: [221.4, 253.7, 164.8, 968.8],
    13.84: [438.9, 1776.1, 614.4, 535.8],
    18.21: [540.9, 5708.8, 1188.9, 604.3],
    19: [736.4, 13701, 2088.1, 795.8],
    19.76: [938.3, 22708.1, 2892.4, 992.2],
    27.71: [1119.4, 40722.4, 4346, 1372.7],
    28.47: [1125.5, 60132.2, 5485, 1647.2],
}

rolling_shear_table = {
    1: [3.01644, 3.591, 3.01644, 3.591, 0],
    2: [2.10672, 2.53764, 2.10672, 2.53764, 2.29824]
}

# Stress values for different species and marine plywood
stress_of_plywood = {
	"Fb": {
		1: [68.4684, 95.76, 56.9772, 79.002, 79.002],
		2: [46.9224, 67.032, 39.2616, 57.456, 57.456],
		3: [46.9224, 67.032, 39.2616, 57.456, 57.456],
		4: [45.0072, 63.6804, 37.3464, 53.1468, 53.1468],
	},
	"fc": {
		1: [46.4436, 78.5232, 43.092, 73.7352, 73.7352],
		2: [34.9524, 57.456, 32.5584, 52.668, 52.668],
		3: [29.2068, 50.7528, 27.7704, 45.486, 45.486],
		4: [29.2068, 47.88, 27.7704, 45.486, 45.486],
	},
	"Fv": {
		1: [7.4214, 9.0972, 7.4214, 9.0972, 7.6608],
		2: [5.7456, 6.7032, 5.7456, 6.7032, 5.7456],
		3: [5.7456, 6.7032, 5.7456, 6.7032, 5.7456],
		4: [5.2668, 6.2244, 5.2668, 6.2244, 5.5062],
	},
	"g": {
		1: [3351.6, 4309.2, 3351.6, 4309.2, 3926.16],
		2: [2872.8, 3591, 2872.8, 3591, 3255.84],
		3: [2394, 2872.8, 2394, 2872.8, 2633.4],
		4: [2154.6, 2394, 2154.6, 2394, 2154.6],
	},
	"fcper": {
		1: [10.0548, 16.2792, 10.0548, 16.2792, 16.2792],
		2: [6.4638, 10.0548, 6.4638, 10.0548, 10.0548],
		3: [6.4638, 10.0548, 6.4638, 10.0548, 10.0548],
		4: [5.0274, 7.6608, 5.0274, 7.6608, 7.6608],
	},
	"E": {
		1: [71820, 86184, 71820, 86184, 86184],
		2: [62244, 71820, 62244, 71820, 71820],
		3: [52668, 57456, 52668, 57456, 57456],
		4: [43092, 47880, 43092, 47880, 47880],
	},
	"Fss": {
		5: [3.01644, 3.591, 3.01644, 3.591, 0],
		6: [2.10672, 2.53764, 2.10672, 2.53764, 2.29824],
	}
}

plyform_stress = {
	1: {
		"Fb": 13306.89,
		"Fs": 496.42,
		"E": 11376354,
		"Ee": 10342140,
	},
	2: {
		"Fb": 9170.03,
		"Fs": 496.42,
		"E": 9859506.8,
		"Ee": 8963188,
	},
	3: {
		"Fb": 13306.89,
		"Fs": 703.27,
		"E": 11376354,
		"Ee": 10342140,
	}
}

ls_constant_mapper = {
	1: 24,
	2: 19.2,
	3: 20,
}

big_table = {
    "1x4": {"Net Area": 66.548, "Ix": 1115500.222, "Sx": 25076.7, "Iy": 51196.4654, "Sy": 5375.92},
    "1x6": {"Net Area": 104.648, "Ix": 4328806.83, "Sx": 61954.2, "Iy": 80332.66522, "Sy": 8457.24},
    "1x8": {"Net Area": 137.922, "Ix": 9914632.567, "Sx": 107682.3, "Iy": 106139.0136, "Sy": 11145.2},
    "1x10": {"Net Area": 176.022, "Ix": 20590968.64, "Sx": 175373, "Iy": 135275.2135, "Sy": 14210.13},
    "1x12": {"Net Area": 214.122, "Ix": 37040434.6, "Sx": 259289.8, "Iy": 164827.6447, "Sy": 17291.45},
    "2x4": {"Net Area": 133.35, "Ix": 2231000.443, "Sx": 501531.4, "Iy": 409571.7232, "Sy": 21520.07},
    "2x6": {"Net Area": 209.55, "Ix": 8657613.661, "Sx": 123908.4, "Iy": 643910.016, "Sy": 33812.57},
    "2x8": {"Net Area": 276.098, "Ix": 19825102.82, "Sx": 215364.6, "Iy": 848695.8776, "Sy": 44564.41},
    "2x10": {"Net Area": 352.298, "Ix": 41177774.97, "Sx": 350582.1, "Iy": 1083450.402, "Sy": 56856.91},
    "2x12": {"Net Area": 428.498, "Ix": 74076706.89, "Sx": 518579.6, "Iy": 1316956.232, "Sy": 69149.41},
    "3x4": {"Net Area": 222.25, "Ix": 3716946.634, "Sx": 83589, "Iy": 1898015.303, "Sy": 59823.5},
    "3x6": {"Net Area": 349.25, "Ix": 14426581.23, "Sx": 206514, "Iy": 2980217.01, "Sy": 93914.7},
    "3x8": {"Net Area": 460.248, "Ix": 33044612.91, "Sx": 358941, "Iy": 3929224.661, "Sy": 123744.5},
    "3x10": {"Net Area": 587.248, "Ix": 68628237.52, "Sx": 584303.5, "Iy": 5011426.369, "Sy": 157999.6},
    "3x12": {"Net Area": 714.248, "Ix": 123466727.9, "Sx": 864244.7, "Iy": 6097790.391, "Sy": 192090.8},
    "4x4": {"Net Area": 311.15, "Ix": 5202892.825, "Sx": 117188.5, "Iy": 5207055.139, "Sy": 117188.5},
    "4x6": {"Net Area": 488.95, "Ix": 20199711.1, "Sx": 289283.5, "Iy": 8178947.521, "Sy": 184059.7},
    "4x8": {"Net Area": 644.652, "Ix": 46259960.69, "Sx": 502517.4, "Iy": 10780393.93, "Sy": 242572},
    "4x10": {"Net Area": 822.198, "Ix": 96082862.38, "Sx": 818024.9, "Iy": 13756448.63, "Sy": 309607.1},
    "4x12": {"Net Area": 999.998, "Ix": 172852586.6, "Sx": 1210073.7, "Iy": 16732503.33, "Sy": 376478.3},
    "5x5": {"Net Area": 514.35, "Ix": 14222627.83, "Sx": 248964.1, "Iy": 14222627.83, "Sy": 248964.1},
    "6x6": {"Net Area": 768.35, "Ix": 31737646.23, "Sx": 454494.7, "Iy": 31741808.55, "Sy": 454494.7},
    "6x8": {"Net Area": 1047.75, "Ix": 80478346.22, "Sx": 845068.4, "Iy": 43279743.68, "Sy": 619705.9},
    "6x10": {"Net Area": 1327.15, "Ix": 163978532.6, "Sx": 1355944.7, "Iy": 54821841.12, "Sy": 785081},
    "6x12": {"Net Area": 1606.55, "Ix": 290138277.8, "Sx": 1986468, "Iy": 66363938.56, "Sy": 950292.2},
    "8x8": {"Net Area": 1428.75, "Ix": 109760227, "Sx": 1152380.9, "Iy": 109747740.1, "Sy": 1152380.9},
    "8x10": {"Net Area": 1809.75, "Ix": 223058421.2, "Sx": 1848792, "Iy": 139012971.7, "Sy": 1459693.4},
    "8x12": {"Net Area": 2190.75, "Ix": 395627970.4, "Sx": 2709267, "Iy": 168278203.2, "Sy": 1767005.9},
    "10x10": {"Net Area": 2292.35, "Ix": 282537892, "Sx": 2342131, "Iy": 282517080.4, "Sy": 2342131},
    "10x12": {"Net Area": 2774.95, "Ix": 501142636.9, "Sx": 3432066, "Iy": 341996551.2, "Sy": 2851532.2},
    "12x12": {"Net Area": 3359.15, "Ix": 606657303.4, "Sx": 4154865, "Iy": 606657303.4, "Sy": 4154537.2},
}

# Dictionary mapping inch-based sizes to metric equivalents
inch_to_metric = {
    "1x4": "19.05*88.9",
    "1x6": "19.05*139.7",
    "1x8": "19.05*184.15",
    "1x10": "19.05*234.95",
    "1x12": "19.05*285.75",
    "2x4": "38.1*88.9",
    "2x6": "38.1*139.7",
    "2x8": "38.1*184.15",
    "2x10": "38.1*234.95",
    "2x12": "38.1*285.75",
    "3x4": "63.5*88.9",
    "3x6": "63.5*139.7",
    "3x8": "63.5*184.15",
    "3x10": "63.5*234.95",
    "3x12": "63.5*285.75",
    "4x4": "88.9*88.9",
    "4x6": "88.9*139.7",
    "4x8": "88.9*184.15",
    "4x10": "88.9*234.95",
    "4x12": "88.9*285.75",
    "5x5": "114.3*114.3",
    "6x6": "139.7*139.7",
    "6x8": "139.7*190.5",
    "6x10": "139.7*241.3",
    "6x12": "139.7*292.1",
    "8x8": "190.5*190.5",
    "8x10": "190.5*241.3",
    "8x12": "190.5*292.1",
    "10x10": "241.3*241.3",
    "10x12": "241.3*292.1",
    "12x12": "292.1*292.1"
}

# List of available inch-based options
inch_options = [
    "1x4", "1x6", "1x8", "1x10", "1x12",
    "2x4", "2x6", "2x8", "2x10", "2x12",
    "3x4", "3x6", "3x8", "3x10", "3x12",
    "4x4", "4x6", "4x8", "4x10", "4x12",
    "5x5", "6x6", "6x8", "6x10", "6x12",
    "8x8", "8x10", "8x12", "10x10", "10x12",
    "12x12"
]


species_and_nominal_table = {
    "dou1": {
        "Fb": 47.88, "Fv": 8.6184, "Fcper": 29.925, "Fcpar": 71.82, "E": 81396, "Emin": 29685.6
    },
    "dou2": {
        "Fb": 43.092, "Fv": 8.6184, "Fcper": 29.925, "Fcpar": 64.638, "E": 76608, "Emin": 27770.4
    },
    "hem1": {
        "Fb": 46.683, "Fv": 7.182, "Fcper": 19.3914, "Fcpar": 64.638, "E": 71820, "Emin": 26334
    },
    "hem2": {
        "Fb": 40.698, "Fv": 7.182, "Fcper": 19.3914, "Fcpar": 62.244, "E": 62244, "Emin": 22503.6
    },
    "spr1": {
        "Fb": 41.895, "Fv": 6.4638, "Fcper": 20.349, "Fcpar": 55.062, "E": 67032, "Emin": 24418.8
    },
    "spr2": {
        "Fb": 41.895, "Fv": 6.4638, "Fcper": 20.349, "Fcpar": 55.062, "E": 67032, "Emin": 24418.8
    }
}

# Mapper to map species index to species type
species_nominal_mapper = {
    1: "dou",
    2: "hem",
    3: "spr"
}

# Dictionary of adjustment factors based on key values
adjustments_factor = {
    1:  [1, 1, 1],
    2:  [1.5, 1.5, 1.15],
    3:  [1.5, 1.5, 1.15],
    4:  [1.5, 1.5, 1.15],
    5:  [1.4, 1.4, 1.1],
    6:  [1.3, 1.3, 1.1],
    8:  [1.2, 1.3, 1.05],
    10: [1.1, 1.2, 1],
    12: [1, 1.1, 1],
}

